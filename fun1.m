function y=fun1(x,w)
global mu q0 epsilon L
z=x+w*1i;
fenmu=(cos((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon) - (sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*i))./((mu./2 + z).^2 + q0.^2).^(1./2)).*(cos((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon) + (sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*(-i)))./((mu./2 - z).^2 + q0.^2).^(1./2)) - (q0.^2.*sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon))./(((mu./2 + z).^2 + q0.^2).^(1./2).*((mu./2 - z).^2 + q0.^2).^(1./2));
fenzi=(q0.^2.*sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu + 2.*z))./(2.*((mu./2 + z).^2 + q0.^2).^(3./2).*((mu./2 - z).^2 + q0.^2).^(1./2)) - (cos((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon) + (sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*(-i)))./((mu./2 - z).^2 + q0.^2).^(1./2)).*((sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*i)./((mu./2 + z).^2 + q0.^2).^(1./2) - (sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*i).*(mu + 2.*z))./(2.*((mu./2 + z).^2 + q0.^2).^(3./2)) + (L.*sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*(mu + 2.*z))./(2.*epsilon.*((mu./2 + z).^2 + q0.^2).^(1./2)) + (L.*cos((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*i).*(mu + 2.*z))./(2.*epsilon.*((mu./2 + z).^2 + q0.^2))) - (q0.^2.*sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu - 2.*z))./(2.*((mu./2 + z).^2 + q0.^2).^(1./2).*((mu./2 - z).^2 + q0.^2).^(3./2)) - (cos((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon) - (sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*i))./((mu./2 + z).^2 + q0.^2).^(1./2)).*((sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*i)./((mu./2 - z).^2 + q0.^2).^(1./2) - (sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*(-i)).*(mu - 2.*z))./(2.*((mu./2 - z).^2 + q0.^2).^(3./2)) - (L.*sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu - 2.*z))./(2.*epsilon.*((mu./2 - z).^2 + q0.^2).^(1./2)) + (L.*cos((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu.*(i./2) + z.*(-i)).*(mu - 2.*z))./(2.*epsilon.*((mu./2 - z).^2 + q0.^2))) - (L.*q0.^2.*cos((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*sin((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu + 2.*z))./(2.*epsilon.*((mu./2 + z).^2 + q0.^2).*((mu./2 - z).^2 + q0.^2).^(1./2)) + (L.*q0.^2.*sin((L.*((mu./2 + z).^2 + q0.^2).^(1./2))./epsilon).*cos((L.*((mu./2 - z).^2 + q0.^2).^(1./2))./epsilon).*(mu - 2.*z))./(2.*epsilon.*((mu./2 + z).^2 + q0.^2).^(1./2).*((mu./2 - z).^2 + q0.^2));
y=z.*fenzi./fenmu;
end
